{"version":3,"sources":["../../moh.js/handsontable/workbook-gui.js"],"names":["SCALE","global","workbookData","WorkbookGUI","mode","workbookName","height","$","window","addSheetTab","currSheet","sheetNames","tables","tabContents","tabs","tabCounter","gridIds","_appendAddSheetTab","container","width","data","rowHeights","colWidths","merges","sheetNo","cells","prop","map","x","Math","round","spec","mergeCells","manualColumnResize","manualRowResize","manualColumnMove","manualRowMove","rowHeaders","colHeaders","autoWrapCol","autoWrapRow","autoRowSize","autoColumnSize","contextMenu","renderAllRows","that","createdTable","Handsontable","push","sheetName","tabColor","gridId","tabContentId","tabId","tabContent","newTab","argb","css","argbToRgb","removeClass","i","length","append","insertBefore","cb","on","html","applyJsonWithStyle","timerStart","Date","now","sheets","hasOwnProperty","ws","name","addTab","applyTabs","position","model","row","top","col","left","rowspan","bottom","colspan","right","addTable","cellProperties","editor","FormulaEditor","renderer","cellRenderer","instance","console","log","style","Object","keys","tab","hideLoadingStatus","event","target","text","cnt","getData","table","substring","td","value","renderers","TextRenderer","apply","arguments","cellMeta","getCellMeta","previousClass","className","undefined","alignment","textAlign","horizontal","vertical","setCellMeta","font","color","bold","fontWeight","italic","fontStyle","fill","fgColor","background","key","border","upper","charAt","toUpperCase","slice","result","error","innerHTML","getWorkbook","workbook","XLSX","utils","book_new","ws_data","worksheet","aoa_to_sheet","book_append_sheet","exportToExcel","fileExtension","writeFile","gui","evaluateFormula","includes","sheet","indexOf","getDataAtCell","calculated","parser","parse","formula","setDataAtCell"],"mappings":"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","sourcesContent":["// Workbook GUI functions...\r\n\r\nconst SCALE = 8; // scale up the column width and row height\r\nlet global = {workbookData: {}};\r\n\r\nclass WorkbookGUI {\r\n    constructor(mode, workbookName, workbookData, height = $(window).height() - 360) {\r\n        this.height = height;\r\n        this.mode = mode; // can be 'view' or 'edit'\r\n        this.addSheetTab = $('<a id=\"add-sheet-btn\" class=\"nav-link nav-item\" href=\"#\"><i class=\"fas fa-plus\"></i> Add Sheet</a>');\r\n        this.workbookName = workbookName;\r\n        global.workbookData = workbookData;\r\n        this.currSheet = '';\r\n        this.sheetNames = [];\r\n        this.tables = [];\r\n        this.tabContents = [];\r\n        this.tabs = [];\r\n        this.tabCounter = 0;\r\n        this.gridIds = [];\r\n        this._appendAddSheetTab();\r\n    }\r\n\r\n    /**\r\n     * Initialize a styled table\r\n     * @param container\r\n     * @param width\r\n     * @param height\r\n     * @param data\r\n     * @param rowHeights\r\n     * @param colWidths\r\n     * @param merges\r\n     * @param sheetNo\r\n     * @param cells\r\n     */\r\n    addTable(container, width, height, data, rowHeights, colWidths, merges, sheetNo, cells) {\r\n        let prop = {};\r\n        if (typeof rowHeights === 'number') {\r\n            prop.rowHeights = rowHeights;\r\n            prop.colWidths = colWidths;\r\n        }\r\n        else {\r\n            prop.rowHeights = rowHeights.map(function (x) {\r\n                return Math.round(x * SCALE / 5.5385);\r\n            });\r\n            prop.colWidths = colWidths.map(function (x) {\r\n                return Math.round(x * SCALE);\r\n            });\r\n        }\r\n        var spec = {\r\n            data: data,\r\n            width: width,\r\n            height: height,\r\n            colWidths: prop.colWidths,\r\n            rowHeights: prop.rowHeights,\r\n            mergeCells: merges,\r\n            manualColumnResize: true,\r\n            manualRowResize: true,\r\n            manualColumnMove: false,\r\n            manualRowMove: false,\r\n            rowHeaders: true,\r\n            colHeaders: true,\r\n            autoWrapCol: false,\r\n            autoWrapRow: false,\r\n            autoRowSize: false,\r\n            autoColumnSize: false,\r\n            contextMenu: ['copy'],\r\n            renderAllRows: false,\r\n            cells: cells,\r\n        };\r\n        const that = this;\r\n        let createdTable = new Handsontable(container, spec);\r\n        createdTable.sheetNo = sheetNo;\r\n        that.tables.push(createdTable);\r\n    }\r\n\r\n    /**\r\n     * Edit mode for create/edit workbook, View mode for user view the workbook\r\n     *\r\n     * @param sheetName\r\n     * @param mode can be either 'edit' or 'view'\r\n     * @param tabColor can be null\r\n     * @return string\r\n     */\r\n    addTab(sheetName, tabColor) {\r\n        var gridId = 'grid-' + this.tabCounter;\r\n        this.gridIds.push(gridId);\r\n        var tabContentId = 'tab-content-' + this.tabCounter;\r\n        var tabId = 'tab-' + this.tabCounter;\r\n\r\n        // add content\r\n        var tabContent = $('<div id=\"' + tabContentId + '\" class=\"tab-pane active show\"> <div id=\"' + gridId + '\"></div></div>');\r\n        this.tabContents.push(tabContent);\r\n\r\n        // add tab\r\n        var newTab;\r\n        // edit mode have edit button in tabs\r\n        if (this.mode === 'edit') {\r\n            newTab = $('<a id=\"' + tabId + '\" class=\"nav-item nav-link active show\" data-toggle=\"tab\" href=\"#' + tabContentId + '\"> ' + sheetName\r\n                + '<i onclick=\"editSheet(' + this.tabCounter + ')\" class=\"fas fa-pen ml-2\"></i></a>');\r\n        }\r\n        else {\r\n            newTab = $('<a class=\"nav-item nav-link active show\" data-toggle=\"tab\" href=\"#' + tabContentId + '\">' + sheetName + '</a>');\r\n        }\r\n        if (tabColor && tabColor.argb) {\r\n            newTab.css('border-bottom', '3px solid #' + argbToRgb(tabColor.argb));\r\n        }\r\n        this.tabs.push(newTab);\r\n\r\n        this.tabCounter++;\r\n        return gridId;\r\n    }\r\n\r\n    applyTabs() {\r\n        // deactivate previous tab and content\r\n        $('div.active.show').removeClass('active show');\r\n        $('a.active').removeClass('active show');\r\n        let i;\r\n        for (i = 0; i < this.tabContents.length; i++) {\r\n            $('#nav-tabContent').append(this.tabContents[i]);\r\n\r\n            if (this.mode === 'edit') {\r\n                this.tabs[i].insertBefore('#nav-tab a:nth-last-child(1)');\r\n            }\r\n            else {\r\n                $('#nav-tab').append(this.tabs[i]);\r\n            }\r\n        }\r\n        this.tabs = [];\r\n        this.tabContents = [];\r\n    }\r\n\r\n    _appendAddSheetTab() {\r\n        $('#nav-tab').append(this.addSheetTab);\r\n    }\r\n\r\n    setAddSheetCallback(cb) {\r\n        $('#add-sheet-btn').on('click', cb);\r\n    }\r\n\r\n    updateJson(workbookData) {\r\n        global.workbookData = workbookData;\r\n        this.sheetNames = [];\r\n        this.tables = [];\r\n        this.tabContents = [];\r\n        this.tabs = [];\r\n        this.tabCounter = 0;\r\n        this.gridIds = [];\r\n    }\r\n\r\n    load() {\r\n        this.tabCounter = 0;\r\n        // clear tables and tabs\r\n        $('#nav-tab').html('');\r\n        $('#nav-tabContent').html('');\r\n\r\n        if (this.mode === 'edit')\r\n            this._appendAddSheetTab();\r\n\r\n        this.applyJsonWithStyle();\r\n    }\r\n\r\n    // apply json to GUI tables\r\n    applyJsonWithStyle() {\r\n        var timerStart = Date.now();\r\n        // clear global variables\r\n        this.tables = [];\r\n        this.sheetNames = [];\r\n\r\n        // load tabs\r\n        const sheets = global.workbookData.sheets;\r\n        for (var sheetNo in sheets) {\r\n            if (sheets.hasOwnProperty(sheetNo)) {\r\n\r\n                var ws = sheets[sheetNo];\r\n                this.sheetNames.push(ws.name);\r\n                const gridId = this.addTab(ws.name, ws.tabColor);\r\n                this.applyTabs();\r\n                let container = $('#' + gridId)[0];\r\n                let data = ws.data;\r\n\r\n                // transform mergeCells\r\n                var merges = [];\r\n                for (var position in ws.merges) {\r\n                    if (ws.merges.hasOwnProperty(position)) {\r\n                        var model = ws.merges[position].model;\r\n                        merges.push({\r\n                            row: model.top - 1,\r\n                            col: model.left - 1,\r\n                            rowspan: model.bottom - model.top + 1,\r\n                            colspan: model.right - model.left + 1\r\n                        })\r\n                    }\r\n                }\r\n                // generate table\r\n                // worksheet has no style\r\n                if (!ws.row) {\r\n                    this.addTable(container, $('#nav-tab').width(), this.height, data,\r\n                        23, 80, true, sheetNo, function (row, col) {\r\n                            let cellProperties = {};\r\n                            cellProperties.editor = FormulaEditor;\r\n                            cellProperties.renderer = cellRenderer;\r\n                            return cellProperties;\r\n                        });\r\n                }\r\n                else {\r\n                    this.addTable(container, $('#nav-tab').width(), this.height, data,\r\n                        ws.row.height, ws.col.width, merges, sheetNo, function (row, col) {\r\n                            let cellProperties = {};\r\n                            if (!('sheetNo' in this.instance)) {\r\n                                this.instance.sheetNo = sheetNo;\r\n                                console.log(sheetNo)\r\n                            }\r\n                            var ws = global.workbookData.sheets[this.instance.sheetNo];\r\n\r\n                            cellProperties.style = null;\r\n                            if (ws.style.length > 0 && ws.style[row] && ws.style[row].length > col && ws.style[row][col] && Object.keys(ws.style[row][col]).length !== 0) {\r\n                                cellProperties.style = ws.style[row][col];\r\n                            }\r\n                            cellProperties.renderer = cellRenderer;\r\n                            cellProperties.editor = FormulaEditor;\r\n\r\n                            return cellProperties;\r\n                        })\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        $('#nav-tab a:first-child').tab('show');\r\n        this.currSheet = this.sheetNames[0];\r\n        hideLoadingStatus();\r\n        const that = this;\r\n        // setTimeout(function () {\r\n        //     that.tables[0].render();\r\n        //     hideLoadingStatus();\r\n        // }, 0);\r\n        // add listener to tabs\r\n        $('.nav-tabs a').on('show.bs.tab', function (event) {\r\n            that.currSheet = $(event.target).text();         // active tab\r\n            // if (!that.rendered[that.currSheet]) {\r\n            //     updateStatus('Rendering...');\r\n            //     setTimeout(function () {\r\n            //         const table = that.tables[that.sheetNames.indexOf(that.currSheet)];\r\n            //         table.render();\r\n            //         clearStatus();\r\n            //     }, 10);\r\n            //     that.rendered[that.currSheet] = true;\r\n            // }\r\n        });\r\n        console.log(\"Time consumed: \", Date.now() - timerStart + 'ms');\r\n    }\r\n\r\n    getData() {\r\n        let cnt = 0;\r\n\r\n        for (let sheetNo in global.workbookData.sheets) {\r\n            if (global.workbookData.sheets.hasOwnProperty(sheetNo)) {\r\n                let ws = global.workbookData.sheets[sheetNo];\r\n                ws.name = this.sheetNames[cnt];\r\n                ws.data = this.tables[cnt].getData();\r\n            }\r\n            cnt++;\r\n        }\r\n        return global.workbookData;\r\n    }\r\n\r\n    addSheet(sheetName, data) {\r\n        const sheetNo = this.sheetNames.length;\r\n        global.workbookData.sheets[sheetNo] = {name: sheetName, data: data};\r\n        this.sheetNames.push(sheetName);\r\n        const gridId = this.addTab(sheetName);\r\n        this.applyTabs();\r\n        let container = $('#' + gridId)[0];\r\n        let table = this.addTable(container, $('#nav-tab').width(), this.height, data,\r\n            23, 80, true, sheetNo, function (row, col) {\r\n                let cellProperties = {};\r\n                cellProperties.editor = FormulaEditor;\r\n                cellProperties.renderer = cellRenderer;\r\n                return cellProperties;\r\n            });\r\n        this.tables.push(table);\r\n\r\n        $('#nav-tab a:first-child').tab('show');\r\n        this.currSheet = this.sheetNames[0];\r\n        // add listener to tabs\r\n        $('.nav-tabs a').on('show.bs.tab', function (event) {\r\n            this.currSheet = $(event.target).text();         // active tab\r\n        });\r\n    }\r\n}\r\n\r\nfunction argbToRgb(argb) {\r\n    return argb.substring(2);\r\n}\r\n\r\nfunction cellRenderer(instance, td, row, col, prop, value, cellProperties) {\r\n    Handsontable.renderers.TextRenderer.apply(this, arguments);\r\n    if (('style' in cellProperties) && cellProperties.style) {\r\n        var style = cellProperties.style;\r\n        // alignment\r\n        var cellMeta = instance.getCellMeta(row, col);\r\n        var previousClass = (cellMeta.className !== undefined) ? cellMeta.className : '';\r\n\r\n        if (style.hasOwnProperty('alignment')) {\r\n            if (style.alignment.hasOwnProperty('horizontal')) {\r\n                td.style.textAlign = style.alignment.horizontal;\r\n            }\r\n            if (style.alignment.hasOwnProperty('vertical')) {\r\n\r\n                switch (style.alignment.vertical) {\r\n                    case 'top':\r\n                        instance.setCellMeta(row, col, 'className', previousClass + ' htTop');\r\n                        break;\r\n                    case 'middle':\r\n                        instance.setCellMeta(row, col, 'className', previousClass + ' htMiddle');\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            // default bottom\r\n            instance.setCellMeta(row, col, 'className', previousClass + ' htBottom');\r\n        }\r\n\r\n        // font\r\n        if (style.hasOwnProperty('font')) {\r\n            if (style.font.hasOwnProperty('color') && style.font.color.hasOwnProperty('argb')) {\r\n                td.style.color = '#' + argbToRgb(style.font.color.argb);\r\n            }\r\n            if (style.font.hasOwnProperty('bold') && style.font.bold) {\r\n                td.style.fontWeight = 'bold';\r\n            }\r\n            if (style.font.hasOwnProperty('italic') && style.font.italic) {\r\n                td.style.fontStyle = 'italic';\r\n            }\r\n        }\r\n\r\n        // background\r\n        if (style.hasOwnProperty('fill')) {\r\n            if (style.fill.hasOwnProperty('fgColor') && style.fill.fgColor.hasOwnProperty('argb')) {\r\n                td.style.background = '#' + argbToRgb(style.fill.fgColor.argb);\r\n            }\r\n        }\r\n\r\n        // borders\r\n        if (style.hasOwnProperty('border')) {\r\n            for (var key in style.border) {\r\n                if (style.border.hasOwnProperty(key)) {\r\n                    var upper = key.charAt(0).toUpperCase() + key.slice(1);\r\n                    var border = style.border[key];\r\n                    if (border.hasOwnProperty('color') && border.color.hasOwnProperty('argb')) {\r\n                        td.style['border' + upper] = '1px solid #' + argbToRgb(border.color.argb);\r\n                    }\r\n                    else {\r\n                        // black color\r\n                        td.style['border' + upper] = '1px solid #000';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // render formula\r\n    if (value && typeof value === 'object' && value.hasOwnProperty('formula')) {\r\n        if (value.result && value.result.error) {\r\n            td.innerHTML = value.result.error;\r\n        }\r\n        else {\r\n            td.innerHTML = value.result !== undefined ? value.result : null;\r\n        }\r\n    }\r\n    // render dropdown\r\n}\r\n\r\nfunction getWorkbook(sheets, sheetNames) {\r\n    // create a workbook\r\n    var workbook = XLSX.utils.book_new();\r\n    for (var i = 0; i < sheets.length; i++) {\r\n        var ws_data = sheets[i].getData();\r\n        var worksheet = XLSX.utils.aoa_to_sheet(ws_data);\r\n        // Add the worksheet to the workbook\r\n        XLSX.utils.book_append_sheet(workbook, worksheet, sheetNames[i]);\r\n    }\r\n    return workbook;\r\n}\r\n\r\nfunction exportToExcel(workbook, name) {\r\n    var fileExtension = '.xlsx';\r\n    // empty params\r\n    if (typeof workbook === 'undefined') {\r\n        return XLSX.writeFile(getWorkbook(gui.tables, gui.sheetNames), gui.workbookName + fileExtension);\r\n    }\r\n    else {\r\n        XLSX.writeFile(workbook, name + fileExtension);\r\n    }\r\n}\r\n\r\n// re-evaluate formula\r\nfunction evaluateFormula(sheetName, row, col) {\r\n    if (!sheetNames.includes(sheetName)) {\r\n        console.log('Error: sheetName not found.');\r\n        return\r\n    }\r\n    var sheet = sheets[sheetNames.indexOf(sheetName)];\r\n    var data = sheet.getDataAtCell(row, col);\r\n    if (!data.hasOwnProperty('formula')) {\r\n        console.log('Error: evaluateFormula(): cell provided is not a formula');\r\n        return\r\n    }\r\n\r\n    var calculated = parser.parse(data.formula);\r\n    if (calculated.error) {\r\n        data.result = calculated;\r\n    }\r\n    else {\r\n        data.result = calculated.result;\r\n    }\r\n\r\n    sheet.setDataAtCell(row, col, data);\r\n    return data;\r\n}\r\n"],"file":"workbook-gui.js"}