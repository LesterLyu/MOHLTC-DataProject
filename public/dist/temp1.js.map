{"version":3,"sources":["../moh.js/temp1.js"],"names":["workbookData","showModalAlert","title","msg","$","find","html","end","modal","document","ready","workbookName","val","url","encodeURIComponent","ajax","type","done","response","console","log","success","workBook","workbook","data","hide","fail","xhr","status","error","responseJSON","message","on","btn","statusText","prop","i","sheets","length","sheetNames","getData","contentType","JSON","stringify","name","exportToExcel","click","change","e","files","target","f","formData","FormData","append","cache","processData","applyJsonWithStyle"],"mappings":"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","sourcesContent":["var workbookData = {};\r\n\r\nfunction showModalAlert(title, msg) {\r\n    $('#msg-modal').find('h5').html(title).end().find('p').html(msg).end().modal('show');\r\n}\r\n\r\n$(document).ready(function () {\r\n    workbookName = $('#filled-workbook').val();\r\n    // default url is for fill the workbook first time\r\n    var url = '/api/filled-workbook/' + encodeURIComponent(workbookName);\r\n    $.ajax({\r\n        url: url,\r\n        type: 'GET',\r\n    }).done(function (response) {\r\n        console.log(response);\r\n        if (response.success) {\r\n            var workBook = response.workbook.data;\r\n            console.log(workBook);\r\n            //applyJsonWithoutStyle(workBook);\r\n            $('#loading').hide();\r\n        }\r\n    }).fail(function (xhr, status, error) {\r\n        console.log('fail ' + xhr.responseJSON.message);\r\n        $('#loading').hide();\r\n        //showErrorAlert(xhr.responseJSON.message);\r\n    });\r\n\r\n});\r\n\r\n$('#save-workbook-btn').on('click', function () {\r\n    var btn = $(this);\r\n    var statusText = $('#status');\r\n    statusText.html('<i class=\"fas fa-spinner fa-spin\"></i> Saving');\r\n    btn.prop('disabled', true);\r\n    var workbook = {};\r\n    for (var i = 0; i < sheets.length; i++) {\r\n        workbook[sheetNames[i]] = sheets[i].getData();\r\n    }\r\n\r\n    $.ajax({\r\n        url: '/api/filled-workbook',\r\n        type: 'POST',\r\n        contentType: 'application/json',\r\n        data: JSON.stringify({data: workbook, name: $('#filled-workbook').val()}),\r\n    }).done(function (response) {\r\n        if (response.success) {\r\n            console.log(response);\r\n            statusText.html('<i class=\"fas fa-check\"></i> Saved');\r\n            btn.prop('disabled', false);\r\n        }\r\n    }).fail(function (xhr, status, error) {\r\n        console.log('fail ' + xhr.responseJSON.message);\r\n        statusText.html('<i class=\"fas fa-times\"></i> Failed to save workbook: ' + xhr.responseJSON.message);\r\n        btn.prop('disabled', false);\r\n    });\r\n});\r\n\r\n$('#export-workbook-btn').on('click', function () {\r\n    exportToExcel();\r\n});\r\n\r\n$('#import-workbook-btn').on('click', function () {\r\n    $('#file-import').click();\r\n});\r\n\r\n$('#file-import').change(function (e) {\r\n\r\n    var files = e.target.files, f = files[0];\r\n    var formData = new FormData();\r\n    formData.append('excel', f);\r\n\r\n    $.ajax({\r\n        url: '/api/upload/' + encodeURIComponent($('#filled-workbook').val() + '.xlsx'),\r\n        type: 'POST',\r\n        data: formData,\r\n        cache: false,\r\n        contentType: false,\r\n        processData: false\r\n    }).done(function (response) {\r\n        if (response.success) {\r\n            console.log(response);\r\n            workbookData = response.data;\r\n            applyJsonWithStyle(response.data);\r\n        }\r\n    }).fail(function (xhr, status, error) {\r\n        console.log('fail ' + xhr.responseJSON.message);\r\n\r\n    });\r\n\r\n});\r\n"],"file":"temp1.js"}